<!-- lab080.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 080</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="../assets/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet" />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a
                    href="https://github.com/vonds/exit_0"
                    target="_blank"
                    rel="noopener"
                  >
                    exit_0
                  </a>
                </li>
                <li>
                  <a
                    href="https://github.com/vonds/sentinel"
                    target="_blank"
                    rel="noopener"
                  >
                    Sentinel
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener">
                    exit_0 Documentation
                  </a>
                </li>
              </ul>
            </li>

            <li>
              <a
                href="https://www.linkedin.com/in/vonds/"
                target="_blank"
                rel="noopener"
              >
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav
        class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top"
      >
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 80: Installing and Configuring Postfix (MTA)
          </h2>

          <nav class="lab-pagination">
            <a
              id="prev-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Previous lab"
            >
              &laquo;
            </a>
            <a
              id="next-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Next lab"
            >
              &raquo;
            </a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Install and start Postfix as a local Mail Transfer Agent (MTA) so the host can deliver service notifications and cron
                output. Validate service health, set a basic mail identity, send a test message to the local <code>root</code> mailbox,
                and confirm the message is actually delivered.
              </p>

              <!-- Video (kept on page; not in left nav) -->
              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      src="https://www.youtube.com/embed/86jnEwyVG5M?si=Q6aFTzIO6R0z41p7"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip">
                    <span class="lab-chip-key">mail</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">services</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">core</span>
                  </span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Scenario
                </h3>

                <p>
                  You need a working local MTA so system-generated mail (cron output, security alerts, logrotate notices, and service
                  notifications) does not disappear silently. This host does not need to relay mail to the internet, but it must deliver
                  mail locally and reliably across reboots.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    A local MTA is still common in hardened environments. Even without an external relay, local delivery preserves
                    operational signal (alerts, automation output) when something goes wrong.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Objective
                </h3>

                <ul>
                  <li>Install Postfix with the system package manager.</li>
                  <li>Enable and start <code>postfix</code> at boot.</li>
                  <li>Verify service health with <code>systemctl</code>.</li>
                  <li>Set a basic mail identity (local domain/hostname context).</li>
                  <li>Send and verify a test message to <code>root</code>.</li>
                </ul>
              </section>

              <!-- Concepts -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Concepts
                </h3>

                <ul>
                  <li>
                    Postfix accepts mail from local processes and delivers it to local mailboxes (or relays it if configured).
                  </li>
                  <li>
                    “Local MTA” does not mean “public mail server.” The default target here is local delivery for system accounts.
                  </li>
                  <li>
                    Verification means checking the service, queue/logs, and the mailbox itself (not just “command ran”).
                  </li>
                  <li>
                    Mail identity (hostname/domain) impacts sender headers and how local mail tools format addresses.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Walkthrough
                </h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>
                    : Install Postfix.
                  </div>

                  <div class="lab-callout">
                    <div class="lab-callout-label">Note</div>
                    <p class="m-b-0">
                      Use the native package manager for your distro. If you are on RHEL-based systems, use <code>dnf</code> (not legacy
                      <code>yum</code>).
                    </p>
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Commands</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-1">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-1"># RHEL / CentOS / Fedora
sudo dnf install -y postfix mailx

# Debian/Ubuntu
sudo apt update
sudo apt install -y postfix bsd-mailx

# Arch
sudo pacman -S postfix mailutils</code></pre>
                  </div>

                  <p>
                    Postfix provides the MTA. The mail client package provides <code>mail</code> so you can send and read local test mail
                    during validation.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Installing Postfix and mail client... Done.</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>
                    : Enable and start Postfix.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-2">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-2">sudo systemctl enable --now postfix</code></pre>
                  </div>

                  <p>
                    <code>enable</code> ensures it starts on boot; <code>--now</code> starts it immediately so you can verify state.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Created symlink .../multi-user.target.wants/postfix.service → .../postfix.service.
Job for postfix.service started successfully.</code></pre>
                  </div>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>
                    : Verify service health.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Commands</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-3">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-3">systemctl status postfix --no-pager
ss -lntp | grep -E ':(25|587)\s' || true</code></pre>
                  </div>

                  <p>
                    Confirm the unit is active and that Postfix is listening locally. Depending on defaults, you may see port 25 (SMTP)
                    and possibly 587 (submission).
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>● postfix.service - Postfix Mail Transport Agent
Active: active (running)

LISTEN 0 100 127.0.0.1:25 ... master</code></pre>
                  </div>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>
                    : Set a basic mail identity (mail domain/hostname context).
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Commands</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-4">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-4"># Set a minimal mailname (common on Debian-based systems)
echo 'example.local' | sudo tee /etc/mailname

# Set Postfix myhostname/mydomain explicitly (works everywhere)
sudo postconf -e 'myhostname=mail01.example.local'
sudo postconf -e 'mydomain=example.local'
sudo postconf -e 'myorigin=$mydomain'

sudo systemctl restart postfix</code></pre>
                  </div>

                  <p>
                    This establishes predictable sender identity for local mail. Restart Postfix so settings are applied.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>postfix/postconf: updated configuration
postfix restarted.</code></pre>
                  </div>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>
                    : Send a test message to local <code>root</code>.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-5">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-5">echo 'Postfix local delivery test' | mail -s 'postfix-test' root</code></pre>
                  </div>

                  <p>
                    This validates local submission into the MTA. Next you confirm the message lands in root’s mailbox.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Message accepted for delivery.</code></pre>
                  </div>
                </div>

                <!-- Step 6 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 6</strong>
                    : Verify delivery (mailbox, queue, logs).
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Commands</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-6">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-6"># Read root mail (interactive)
sudo mail -u root

# Check queue (should be empty for local delivery)
mailq

# Check service logs (systemd journal)
sudo journalctl -u postfix --no-pager -n 50</code></pre>
                  </div>

                  <p>
                    Your “done” signal is: message visible in the root mailbox, queue not building up, and no obvious delivery errors in logs.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example: mail shows a new message with subject "postfix-test"
# Example: mailq returns "Mail queue is empty"</code></pre>
                  </div>
                </div>
              </section>

              <!-- Breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Common breakpoints
                </h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">postfix is running, but mail never arrives</div>
                  <p class="m-b-0">
                    Check <code>mailq</code> for stuck messages, then inspect <code>journalctl -u postfix</code> for local delivery errors.
                    Also confirm you installed a mail client package so you can read local mail.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">port 25 is not listening</div>
                  <p class="m-b-0">
                    Re-check the unit state (<code>systemctl status postfix</code>) and whether Postfix is configured for loopback-only binding.
                    If you hardened the host, confirm firewall rules and SELinux context if applicable.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">hostname/domain looks wrong in headers</div>
                  <p class="m-b-0">
                    Validate <code>postconf -n</code> output and ensure <code>myhostname</code>, <code>mydomain</code>, and <code>myorigin</code>
                    match your intended identity.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Cleanup checklist
                </h3>

                <p>
                  This lab is safe to leave in place if you want local system mail. If you need to revert, stop/disable the service and
                  remove the packages using your distro’s package manager.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button class="lab-copy-btn" type="button" data-copy="#cmd-cleanup">
                      Copy
                    </button>
                  </div>
                  <pre><code id="cmd-cleanup">sudo systemctl disable --now postfix
mailq</code></pre>
                </div>
              </section>

              <!-- Reference (minimal; commands listed once; sub-bullets only for flags/options) -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Reference
                </h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>dnf install postfix mailx</code>: Install Postfix and a local mail client on RHEL-based systems.
                  </li>

                  <li>
                    <code>apt install postfix bsd-mailx</code>: Install Postfix and a local mail client on Debian-based systems.
                  </li>

                  <li>
                    <code>pacman -S postfix mailutils</code>: Install Postfix and a local mail client on Arch.
                  </li>

                  <li>
                    <code>systemctl enable --now postfix</code>: Enable Postfix at boot and start it immediately.
                  </li>

                  <li>
                    <code>systemctl status postfix</code>: Show Postfix unit health and current runtime state.
                  </li>

                  <li>
                    <code>postconf -e 'key=value'</code>: Set Postfix configuration values non-interactively.
                    <ul>
                      <li><code>myhostname</code>: Host identity used in mail headers.</li>
                      <li><code>mydomain</code>: Domain portion for local mail identity.</li>
                      <li><code>myorigin</code>: Domain appended to locally-posted mail.</li>
                    </ul>
                  </li>

                  <li>
                    <code>/etc/mailname</code>: Mail name file used on some systems (commonly Debian-based).
                  </li>

                  <li>
                    <code>mail -s '&lt;subject&gt;' &lt;user&gt;</code>: Send a local message with a subject.
                  </li>

                  <li>
                    <code>mail -u &lt;user&gt;</code>: Read a local user’s mailbox interactively.
                  </li>

                  <li>
                    <code>mailq</code>: Display queued messages waiting for delivery.
                  </li>

                  <li>
                    <code>journalctl -u postfix</code>: View Postfix logs from the systemd journal.
                    <ul>
                      <li><code>-n 50</code>: Show the most recent 50 lines.</li>
                      <li><code>--no-pager</code>: Print directly to stdout.</li>
                    </ul>
                  </li>

                  <li>
                    <code>ss -lntp</code>: List listening TCP sockets and owning processes.
                    <ul>
                      <li><code>-l</code>: listening sockets</li>
                      <li><code>-n</code>: numeric addresses/ports</li>
                      <li><code>-t</code>: TCP</li>
                      <li><code>-p</code>: process info</li>
                    </ul>
                  </li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a
                    href="https://github.com/vonds"
                    target="_blank"
                    rel="noopener"
                  >
                    Github
                  </a>
                </li>
                <li>
                  <a
                    href="https://www.linkedin.com/in/vonds/"
                    target="_blank"
                    rel="noopener"
                  >
                    Linkedin
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy;
                <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear()
    </script>
  </body>
</html>
