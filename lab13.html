<!-- lab013.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 013</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="../assets/images/apple-touch-icon-72x72.png" />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet" />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a href="https://github.com/vonds/exit_0" target="_blank" rel="noopener">
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener">
                    exit_0
                  </a>
                </li>
              </ul>
            </li>

            <li>
              <a href="https://www.linkedin.com/in/vonds/" target="_blank" rel="noopener">
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 13: Log Management and Troubleshooting with journalctl
          </h2>

          <nav class="lab-pagination">
            <a id="prev-lab" class="lab-nav-link" href="#" aria-label="Previous lab">&laquo;</a>
            <a id="next-lab" class="lab-nav-link" href="#" aria-label="Next lab">&raquo;</a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Investigate cron execution issues by querying the systemd journal with unit filters and priority views.
                Correlate evidence across journal output and classic log files, then confirm how log rotation is invoked and where rotation policy is defined.
              </p>

              <!-- Video (kept on page; removed width/height so your responsive CSS can control it) -->
              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      src="https://www.youtube.com/embed/WtgvYG04r_0?si=RhdBcHloeUzs1i8H"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip"><span class="lab-chip-key">troubleshooting</span></span>
                  <span class="lab-chip"><span class="lab-chip-key">services</span></span>
                  <span class="lab-chip"><span class="lab-chip-key">core</span></span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Scenario</h3>

                <p>
                  A user reports that cron jobs are not being executed properly. You must inspect cron service logs, pull the most recent
                  high-signal messages with context, filter for failures, and confirm where persistent logs live on disk. To close the loop,
                  identify how log rotation is invoked and where per-service rotation policies are stored.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    When scheduled jobs do not run, the fastest path is proving: (1) the cron daemon is active,
                    (2) the job fired, and (3) output or errors exist somewhere you can read.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Objective</h3>
                <ul>
                  <li>Show service logs for the cron unit using <code>journalctl -u</code>.</li>
                  <li>Pull the most recent unit messages with context using <code>-x</code> and <code>-e</code>.</li>
                  <li>Filter log output for failures using either grep or priority filters.</li>
                  <li>View classic persistent logs under <code>/var/log</code> when present.</li>
                  <li>Display the last 20 journal entries.</li>
                  <li>Identify how log rotation is invoked and where rotation policies live.</li>
                </ul>
              </section>

              <!-- Concepts (no alt-background) -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Concepts</h3>
                <ul>
                  <li>
                    The journal is queryable by unit, time range, and priority. That is usually faster than scanning a full log file.
                  </li>
                  <li>
                    Cron may run as <code>cron</code> or <code>crond</code> depending on distro and packaging.
                  </li>
                  <li>
                    Not all environments persist journal logs to disk. If persistence is disabled, older entries may disappear after reboot.
                  </li>
                  <li>
                    Classic log files under <code>/var/log</code> still matter when rsyslog is in the pipeline or when you need file-based evidence.
                  </li>
                  <li>
                    <code>logrotate</code> manages file-based logs. Policy is typically centralized in <code>/etc/logrotate.conf</code> and <code>/etc/logrotate.d/</code>.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Walkthrough</h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>: Show logs for the cron service unit.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-1">Copy</button>
                    </div>
                    <pre><code id="cmd-step-1">journalctl -u cron
# OR (common on some distros)
journalctl -u crond</code></pre>
                  </div>

                  <p>
                    The <code>-u</code> filter limits output to a single unit. This is your baseline view to confirm the service is starting,
                    receiving jobs, and emitting messages that indicate execution.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example patterns:
systemd[1]: Started Regular background program processing daemon.
CRON[891]: (root) CMD (/usr/local/bin/daily-report.sh)</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>: Show the most recent unit messages with extra context.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-2">Copy</button>
                    </div>
                    <pre><code id="cmd-step-2">journalctl -xeu cron
# OR
journalctl -xeu crond</code></pre>
                  </div>

                  <p>
                    <code>-e</code> jumps to the end (most recent), <code>-x</code> adds explanatory text when available, and <code>-u</code> keeps output scoped to the unit.
                    This is the quickest way to see what just happened.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example patterns:
CRON[1023]: (lab) CMD (/usr/local/bin/backup.sh)
pam_unix(cron:session): session opened for user lab by (uid=0)
pam_unix(cron:session): session closed for user lab</code></pre>
                  </div>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>: Filter logs for failures.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-3">Copy</button>
                    </div>
                    <pre><code id="cmd-step-3">journalctl -p err -b
# OR (quick keyword sweep when you do not know the unit yet)
journalctl -b | grep -i -E 'fail|error|denied'</code></pre>
                  </div>

                  <p>
                    Priority filtering is cleaner than raw grep when you want true errors and above. Adding <code>-b</code> limits output to the current boot,
                    which reduces noise when the report is time-bound.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example patterns:
CRON[1555]: (lab) ERROR (No MTA installed, discarding output)
sudo[1601]: pam_unix(sudo:auth): authentication failure</code></pre>
                  </div>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>: Validate persistent logs under <code>/var/log</code> when present.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-4">Copy</button>
                    </div>
                    <pre><code id="cmd-step-4"># Debian/Ubuntu commonly:
less /var/log/syslog

# RHEL-family commonly:
less /var/log/messages</code></pre>
                  </div>

                  <p>
                    Some environments still write service messages into classic log files (often via rsyslog). This is a quick “is anything being written to disk”
                    check, and it helps when journal retention is short or persistence is disabled.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example patterns:
CRON[1201]: (lab) CMD (/usr/local/bin/backup.sh)
CRON[1201]: (lab) ERROR (No MTA installed, discarding output)</code></pre>
                  </div>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>: Show the last 20 journal entries.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-5">Copy</button>
                    </div>
                    <pre><code id="cmd-step-5">journalctl -n 20</code></pre>
                  </div>

                  <p>
                    This is a fast snapshot when you do not yet know which unit is involved. It is also useful immediately after reproducing an issue.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example header and patterns:
-- Logs begin Mon 2025-07-01 08:00:00 --
CRON[1127]: (root) CMD (/usr/local/bin/daily-report.sh)</code></pre>
                  </div>
                </div>

                <!-- Step 6 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 6</strong>: Trigger log rotation and confirm where policies live.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-6">Copy</button>
                    </div>
                    <pre><code id="cmd-step-6"># Policy locations:
cat /etc/logrotate.conf
ls -l /etc/logrotate.d/

# Run logrotate (dry run first):
sudo logrotate -d /etc/logrotate.conf

# Force a rotation run (use carefully on real systems):
sudo logrotate -f /etc/logrotate.conf</code></pre>
                  </div>

                  <p>
                    <code>logrotate</code> manages file-based logs (typically under <code>/var/log</code>). A dry run shows what would happen without changing anything.
                    Policies are usually split into a global config plus per-service files.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example output clue (dry run):
reading config file /etc/logrotate.conf
including /etc/logrotate.d
considering log /var/log/syslog</code></pre>
                  </div>
                </div>
              </section>

              <!-- Breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Common breakpoints</h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">No output for the unit</div>
                  <p class="m-b-0">
                    The unit name may differ. Try <code>cron</code> and <code>crond</code>, or list candidates with <code>systemctl list-units | grep -i cron</code>.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Logs disappear after reboot</div>
                  <p class="m-b-0">
                    Journal persistence may be disabled. Confirm whether persistent storage is configured, and rely on file-based logs if required.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Cron shows CMD, but nothing else</div>
                  <p class="m-b-0">
                    Cron may discard output if mail is not configured. Redirect stdout and stderr in the job or script so failures are captured.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">logrotate changes too much</div>
                  <p class="m-b-0">
                    Start with <code>logrotate -d</code> to preview behavior. Forcing rotation is useful for validation, but avoid it on production systems without approval.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Cleanup checklist</h3>

                <p>
                  This lab reads logs and configuration. If you created any test cron jobs in earlier labs, remove them separately and verify the crontab is clean.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button class="lab-copy-btn" type="button" data-copy="#cmd-cleanup">Copy</button>
                  </div>
                  <pre><code id="cmd-cleanup">crontab -l
crontab -e</code></pre>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Success signal</div>
                  <p class="m-b-0">
                    You can show (1) unit-scoped journal evidence, (2) filtered error views, and (3) where file-based rotation policy lives for your platform.
                  </p>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Reference</h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>journalctl -u &lt;unit&gt;</code>: Shows journal entries for a specific systemd unit (for example <code>cron</code> or <code>crond</code>).
                  </li>
                  <li>
                    <code>journalctl -xeu &lt;unit&gt;</code>: High-signal view of recent unit messages.
                    <ul>
                      <li><code>-x</code>: Adds explanatory text when available.</li>
                      <li><code>-e</code>: Jumps to the end (most recent).</li>
                      <li><code>-u</code>: Filters output to a single unit.</li>
                    </ul>
                  </li>
                  <li>
                    <code>journalctl -p err -b</code>: Shows error-priority entries from the current boot.
                    <ul>
                      <li><code>-p err</code>: Error severity and above.</li>
                      <li><code>-b</code>: Current boot only.</li>
                    </ul>
                  </li>
                  <li>
                    <code>journalctl -n 20</code>: Displays the last 20 journal entries.
                  </li>
                  <li>
                    <code>/var/log/syslog</code>: Common on Debian/Ubuntu systems (often written via rsyslog).
                  </li>
                  <li>
                    <code>/var/log/messages</code>: Common on RHEL-family systems.
                  </li>
                  <li>
                    <code>logrotate</code>: Rotates, compresses, and manages retention for file-based logs.
                    <ul>
                      <li><code>/etc/logrotate.conf</code>: Main configuration.</li>
                      <li><code>/etc/logrotate.d/</code>: Per-service policies.</li>
                      <li><code>logrotate -d</code>: Dry run (preview).</li>
                      <li><code>logrotate -f</code>: Force a run.</li>
                    </ul>
                  </li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a href="https://github.com/vonds" target="_blank" rel="noopener">Github</a>
                </li>
                <li>
                  <a href="https://www.linkedin.com/in/vonds/" target="_blank" rel="noopener">Linkedin</a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy; <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById("year").textContent = new Date().getFullYear()
    </script>
  </body>
</html>
