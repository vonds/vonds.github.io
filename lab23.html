<!-- lab023.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 023</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="../assets/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles (new) -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet" />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a
                    href="https://github.com/vonds/exit_0"
                    target="_blank"
                    rel="noopener"
                  >
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener">
                    exit_0 Documentation
                  </a>
                </li>
                <li>
                  <a
                    href="https://github.com/vonds/sentinel"
                    target="_blank"
                    rel="noopener"
                  >
                    Sentinel
                  </a>
                </li>
              </ul>
            </li>

            <li>
              <a
                href="https://www.linkedin.com/in/vonds/"
                target="_blank"
                rel="noopener"
              >
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav
        class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top"
      >
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 23: Package Integrity
          </h2>

          <nav class="lab-pagination">
            <a
              id="prev-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Previous lab"
            >
              &laquo;
            </a>
            <a
              id="next-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Next lab"
            >
              &raquo;
            </a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Verify package authenticity and integrity before installation by
                checking signatures, digests, and trusted key stores. Use RPM
                verification tooling and Debian metadata inspection to prove
                you’re not installing tampered or untrusted software.
              </p>

              <!-- Video -->
              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      width="560"
                      height="315"
                      src="https://www.youtube.com/embed/OQ9FuonISnM?si=NWVFfXcL36naivcg"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip">
                    <span class="lab-chip-key">security</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">packages</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">troubleshooting</span>
                  </span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Scenario
                </h3>
                <p>
                  You’ve been handed a package file and asked to validate it
                  before it touches production. The task is simple: confirm the
                  package is authentic, confirm it has not been modified, and
                  confirm the system trusts the signing key. You will perform
                  RPM signature verification, inspect RPM digests, and validate
                  Debian package metadata for integrity signals.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    “It installed fine” is not a control. This workflow is how
                    you prove provenance and integrity before you install
                    anything on a server you care about.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Objective
                </h3>
                <ul>
                  <li>Verify the GPG signature on an RPM package file.</li>
                  <li>
                    Verify signature and digest details for an RPM using verbose
                    verification.
                  </li>
                  <li>
                    Inspect Debian package metadata for integrity-relevant
                    signals.
                  </li>
                  <li>Identify where trusted APT repository keys are stored.</li>
                  <li>Import a trusted public key on an RPM-based system.</li>
                </ul>
              </section>

              <!-- Concepts -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Concepts
                </h3>
                <ul>
                  <li>
                    Authenticity versus integrity: “signed by a trusted key”
                    versus “bytes match what was signed.”
                  </li>
                  <li>
                    RPM signature checks rely on keys present in the RPM
                    database; a valid signature can still be “NOKEY” if the key
                    is not trusted locally.
                  </li>
                  <li>
                    Digest verification validates the package payload (tamper
                    detection) independently of installation success.
                  </li>
                  <li>
                    Debian packages typically rely on repository metadata and
                    signed Release files; local artifact inspection helps you
                    confirm what you were handed.
                  </li>
                  <li>
                    Key import is a trust decision: verify fingerprints through
                    an independent channel before importing.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Walkthrough
                </h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>
                    : Verify the GPG signature on an RPM package file.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-1"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-1">rpm --checksig vim.rpm</code></pre>
                  </div>

                  <p>
                    This checks whether the package signature and digest validate
                    against keys trusted by the RPM database. If the key is
                    missing or untrusted, the check may report
                    <code>NOKEY</code> even if the package is signed.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-1"># Expected patterns:
# vim.rpm: digests signatures OK
# vim.rpm: ... NOKEY (key not imported/trusted locally)</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>
                    : Show detailed signature and digest verification for the RPM.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-2"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-2">rpm -Kv vim.rpm</code></pre>
                  </div>

                  <p>
                    <code>-K</code> verifies signatures and digests and
                    <code>-v</code> provides more explicit output. Use this when
                    you need evidence for both signature validity and payload
                    integrity.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-2"># Expected pattern:
# vim.rpm: ... OK</code></pre>
                  </div>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>
                    : Inspect Debian package metadata (integrity-relevant signals).
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-3"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-3">dpkg-deb --info vim.deb</code></pre>
                  </div>

                  <p>
                    This prints control metadata (package name, version, arch,
                    maintainer, dependencies). Pair it with repository trust
                    checks and published hashes when validating an artifact
                    handoff.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-3"># Expect metadata output including control fields.
# (Checksum fields may not appear here depending on the build.)</code></pre>
                  </div>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>
                    : Identify where trusted APT keys live.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Paths</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-4"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-4">/etc/apt/trusted.gpg
/etc/apt/trusted.gpg.d/</code></pre>
                  </div>

                  <p>
                    These are common legacy trust store locations for APT keys.
                    In modern setups, you may also see per-repository keyrings
                    referenced with <code>signed-by=</code> in source list
                    entries.
                  </p>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>
                    : Import a trusted RPM GPG key.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-5"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-5">rpm --import /path/to/RPM-GPG-KEY</code></pre>
                  </div>

                  <p>
                    Importing a key is a trust decision. In real operations, you
                    verify the key fingerprint from an independent channel
                    before adding it to a host’s trust store.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-5"># Re-run verification after import:
rpm --checksig vim.rpm</code></pre>
                  </div>
                </div>
              </section>

              <!-- Breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Breakpoints
                </h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">rpm --checksig returns NOKEY</div>
                  <p class="m-b-0">
                    The package may be signed, but the signing key is not present
                    in the local RPM database. Validate the key fingerprint via
                    an independent channel, then import the trusted key.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">rpm -Kv reports BAD or NOT OK</div>
                  <p class="m-b-0">
                    Treat this as a hard stop. The artifact may be corrupted,
                    incomplete, or tampered. Re-download from a trusted source
                    and re-verify.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Debian artifact verification feels “thin”</div>
                  <p class="m-b-0">
                    Debian integrity is normally proven through repository trust
                    (signed Release files) and checksums in repo metadata.
                    Metadata inspection helps confirm you received the expected
                    package identity, but does not replace repo signature checks.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Blind key import temptation</div>
                  <p class="m-b-0">
                    Importing a key because verification failed defeats the
                    purpose. Always verify the fingerprint from a trusted
                    source before importing.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Cleanup checklist
                </h3>

                <p>
                  This lab is read-only unless you import a key. If you imported
                  a key on a shared system, confirm it is the correct key and
                  document the trust decision.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button
                      class="lab-copy-btn"
                      type="button"
                      data-copy="#cmd-cleanup"
                    >
                      Copy
                    </button>
                  </div>
                  <pre><code id="cmd-cleanup"># Re-verify the artifact:
rpm --checksig vim.rpm
rpm -Kv vim.rpm</code></pre>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Success signal</div>
                  <p class="m-b-0">
                    RPM verification reports signatures/digests OK and you can
                    explain which key is trusted and why it is trusted.
                  </p>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Reference
                </h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>rpm --checksig &lt;pkg.rpm&gt;</code>
                    : Verifies RPM signature and digest using trusted RPM keys.
                    <ul>
                      <li>
                        <code>--checksig</code>
                        : Checks signature and digest for the package file.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>rpm -Kv &lt;pkg.rpm&gt;</code>
                    : Verifies signature and digest with more detailed output.
                    <ul>
                      <li>
                        <code>-K</code>
                        : Verifies signatures and digests for the package file.
                      </li>
                      <li>
                        <code>-v</code>
                        : Enables verbose verification output.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>dpkg-deb --info &lt;pkg.deb&gt;</code>
                    : Displays Debian package metadata and control fields.
                    <ul>
                      <li>
                        <code>--info</code>
                        : Prints control metadata for the package file.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>rpm --import &lt;keyfile&gt;</code>
                    : Imports a public key into the RPM trust database.
                    <ul>
                      <li>
                        <code>--import</code>
                        : Adds the provided key to the RPM database for signature verification.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>/etc/apt/trusted.gpg</code>
                    : Legacy trusted APT keyring file.
                  </li>

                  <li>
                    <code>/etc/apt/trusted.gpg.d/</code>
                    : Directory containing trusted APT keyring fragments.
                  </li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->

          <nav class="lab-pagination">
            <a id="prev-lab" class="lab-nav-link" href="#" aria-label="Top">
              &uArr;
            </a>
          </nav>
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a href="https://github.com/vonds" target="_blank" rel="noopener">
                    Github
                  </a>
                </li>
                <li>
                  <a
                    href="https://www.linkedin.com/in/vonds/"
                    target="_blank"
                    rel="noopener"
                  >
                    Linkedin
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy;
                <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear()
    </script>
  </body>
</html>
