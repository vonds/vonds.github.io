<!-- lab029.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 029</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="../assets/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles (new) -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet" />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a href="https://github.com/vonds/exit_0" target="_blank" rel="noopener">
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener">
                    exit_0 Documentation
                  </a>
                </li>
                <li>
                  <a href="https://github.com/vonds/sentinel" target="_blank" rel="noopener">
                    Sentinel
                  </a>
                </li>
              </ul>
            </li>

            <li>
              <a href="https://www.linkedin.com/in/vonds/" target="_blank" rel="noopener">
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 29: Monitor User Activity
          </h2>

          <nav class="lab-pagination">
            <a id="prev-lab" class="lab-nav-link" href="#" aria-label="Previous lab">
              &laquo;
            </a>
            <a id="next-lab" class="lab-nav-link" href="#" aria-label="Next lab">
              &raquo;
            </a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Investigate a suspicious after-hours login using core user activity tools and simple log filtering. Identify who is on the
                system, review historical sessions, validate privilege scope, confirm failed login patterns, then mitigate by locking the
                account.
              </p>

              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      width="560"
                      height="315"
                      src="https://www.youtube.com/embed/uJk54bhaadA?si=seGSukCoMFN7ohRo"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip">
                    <span class="lab-chip-key">security</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">core</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">users</span>
                  </span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Scenario
                </h3>

                <p>
                  An overnight access review flagged an unapproved login. A user account that should have been inactive was observed logging in
                  after hours from an unfamiliar IP. Your task is to determine who accessed the system, assess privilege risk, confirm the activity
                  pattern, then decide whether the account should be disabled immediately.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    This is the kind of triage you do before escalating to SOC, collecting forensics, or changing network controls.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Objective
                </h3>

                <ul>
                  <li>Identify who is currently logged in.</li>
                  <li>Inspect current activity and session context.</li>
                  <li>Review login history for after-hours sessions.</li>
                  <li>Validate group membership and sudo authorization.</li>
                  <li>Confirm suspicious activity and failed login attempts.</li>
                  <li>Mitigate by locking the user account.</li>
                </ul>
              </section>

              <!-- Concepts -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Concepts
                </h3>

                <ul>
                  <li>
                    Current sessions come from terminal records, not guesswork. Start with <code>who</code>, then use <code>w</code> for context.
                  </li>
                  <li>
                    Historical sessions come from wtmp. <code>last</code> gives the fastest timeline of logins and sources.
                  </li>
                  <li>
                    Privilege risk is not just root logins. You check group membership, sudo authorization patterns, and any admin groups.
                  </li>
                  <li>
                    Failed login patterns around a successful session can indicate credential guessing or compromise, even if the account is not in sudo.
                  </li>
                  <li>
                    Locking an account preserves evidence while preventing continued access. It is a safe first mitigation while you escalate.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Walkthrough
                </h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>
                    : Display current users logged in.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-1">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-1">who</code></pre>
                  </div>

                  <p>
                    <code>who</code> gives a clean list of active logins and the remote source addresses, which is often the first signal during triage.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-1">devstudent  pts/0        2025-07-18 08:13 (192.168.1.25)
sysmon      pts/1        2025-07-18 08:15 (192.168.1.23)
analyst     pts/2        2025-07-18 08:21 (192.168.1.12)</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>
                    : View what those users are doing right now.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-2">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-2">w</code></pre>
                  </div>

                  <p>
                    <code>w</code> is useful when you need session context fast: how long they have been logged in, idle time, and what is running.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-2">08:30:01 up 2 days,  4:56,  3 users,  load average: 0.45, 0.42, 0.36
USER       TTY      FROM              LOGIN@   IDLE   JCPU   PCPU WHAT
devstudent pts/0    192.168.1.25      08:13    3.00s  0.10s  0.00s bash
sysmon     pts/1    192.168.1.23      08:15    7.00s  0.20s  0.01s top
analyst    pts/2    192.168.1.12      08:21    1:15   0.30s  0.03s vim</code></pre>
                  </div>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>
                    : Review login history for late-night activity.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-3">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-3">last</code></pre>
                  </div>

                  <p>
                    <code>last</code> reads login history and is your quickest way to confirm whether an account was active after hours, and from where.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-3">analyst    pts/2        192.168.1.12    Fri Jul 19 08:21   still logged in
sysmon     pts/1        192.168.1.23    Fri Jul 19 08:15   still logged in
devstudent pts/0        192.168.1.25    Fri Jul 19 08:13   still logged in
intern     pts/3        192.168.1.30    Thu Jul 18 23:59 - 00:15  (00:16)
tester     pts/4        192.168.1.55    Thu Jul 18 23:00 - 23:55  (00:55)
backup     pts/6        127.0.0.1       Thu Jul 18 02:00 - 02:30  (00:30)
root       pts/7        192.168.1.10    Thu Jul 18 01:00 - 01:45  (00:45)</code></pre>
                  </div>

                  <div class="lab-callout">
                    <div class="lab-callout-label">Triage note</div>
                    <p class="m-b-0">
                      The account tester logged in from 192.168.1.55 at 23:00, which is outside normal work hours in this scenario.
                    </p>
                  </div>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>
                    : Check whether tester has elevated roles.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-4">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-4">id tester</code></pre>
                  </div>

                  <p>
                    <code>id</code> shows UID/GID and group memberships. This tells you whether the account has obvious privilege paths through admin groups.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-4">uid=1012(tester) gid=1012(tester) groups=1012(tester)</code></pre>
                  </div>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>
                    : Confirm who is authorized for sudo.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-5">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-5">getent group sudo</code></pre>
                  </div>

                  <p>
                    This checks membership in the sudo group. On some hosts, the admin group is wheel, or authorization is controlled through
                    sudoers includes, but group membership is still a fast first pass.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-5">sudo:x:27:admin,analyst</code></pre>
                  </div>
                </div>

                <!-- Step 6 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 6</strong>
                    : Filter historical activity for the suspicious account.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-6">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-6">last | grep tester</code></pre>
                  </div>

                  <p>
                    This isolates the activity to one account so you can confirm time window, duration, and source address.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-6">tester    pts/4        192.168.1.55    Thu Jul 18 23:00 - 23:55  (00:55)</code></pre>
                  </div>
                </div>

                <!-- Step 7 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 7</strong>
                    : Check for failed logins around the same time.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-7">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-7">grep 'Failed password' /var/log/auth.log</code></pre>
                  </div>

                  <p>
                    Failed authentication attempts can confirm probing before a successful session. On many RHEL-based systems, this is commonly
                    logged in /var/log/secure.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-7">Jul 18 23:02:11 server01 sshd[19112]: Failed password for tester from 192.168.1.55 port 44662
Jul 18 23:02:15 server01 sshd[19113]: Failed password for tester from 192.168.1.55 port 44663</code></pre>
                  </div>

                  <div class="lab-callout">
                    <div class="lab-callout-label">Signal</div>
                    <p class="m-b-0">
                      Multiple failed attempts followed by a successful session is a strong indicator of compromise or credential abuse.
                    </p>
                  </div>
                </div>

                <!-- Step 8 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 8</strong>
                    : Lock the account to prevent future login.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-8">
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-8">passwd -l tester</code></pre>
                  </div>

                  <p>
                    Account locking is fast mitigation while you investigate further. It preserves the account and artifacts while preventing authentication.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-8">passwd: password expiry information changed.</code></pre>
                  </div>
                </div>
              </section>

              <!-- Breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Breakpoints
                </h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">No entries from last</div>
                  <p class="m-b-0">
                    If last returns nothing, the wtmp file may be missing or rotated. Verify the host logs login sessions and that wtmp exists.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Auth log path differs</div>
                  <p class="m-b-0">
                    On some systems the SSH auth log is not in auth.log. If you do not see failed password entries, check the platformâ€™s auth log location.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Group check is not definitive</div>
                  <p class="m-b-0">
                    Sudo access can be controlled in sudoers includes even if the user is not in a sudo group. Group membership is a fast first pass,
                    not a final authorization report.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Cleanup checklist
                </h3>

                <ul>
                  <li>Confirm the account is locked.</li>
                  <li>Capture the relevant session lines for escalation if needed.</li>
                </ul>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button class="lab-copy-btn" type="button" data-copy="#cmd-cleanup">
                      Copy
                    </button>
                  </div>
                  <pre><code id="cmd-cleanup">passwd -S tester
last | grep tester</code></pre>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Reference
                </h3>

                <ul class="lab-reference-list">
                  <li><code>who</code>: List users currently logged in.</li>
                  <li><code>w</code>: Show logged-in users and what they are doing.</li>
                  <li><code>last</code>: Show login history.</li>
                  <li><code>id</code>: Show UID, GID, and group memberships.</li>
                  <li><code>getent</code>: Query system databases.</li>
                  <li><code>getent group sudo</code>: Show members of the sudo group.</li>
                  <li><code>grep</code>: Search text using patterns.</li>
                  <li><code>passwd -l</code>: Lock a user account.</li>
                  <li><code>passwd -S</code>: Show account status and password state.</li>
                  <li><code>/var/log/auth.log</code>: Authentication log location on many Debian-family systems.</li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->

          <nav class="lab-pagination">
            <a id="prev-lab" class="lab-nav-link" href="#" aria-label="Previous lab">
              &uArr;
            </a>
          </nav>
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a href="https://github.com/vonds" target="_blank" rel="noopener">
                    Github
                  </a>
                </li>
                <li>
                  <a href="https://www.linkedin.com/in/vonds/" target="_blank" rel="noopener">
                    Linkedin
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy;
                <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear()
    </script>
  </body>
</html>
