<!-- lab004.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 004</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="../assets/images/apple-touch-icon-72x72.png" />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Dosis" rel="stylesheet" />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a href="https://github.com/vonds/exit_0" target="_blank" rel="noopener">
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener">
                    exit_0 Documentation
                  </a>
                </li>
                <li>
                  <a href="https://github.com/vonds/sentinel" target="_blank" rel="noopener">
                    Sentinel
                  </a>
                </li>
              </ul>
            </li>

            <li>
              <a href="https://www.linkedin.com/in/vonds/" target="_blank" rel="noopener">
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top">
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 4: Using sed To Do SSH Config Hardening
          </h2>

          <nav class="lab-pagination">
            <a id="prev-lab" class="lab-nav-link" href="#" aria-label="Previous lab">&laquo;</a>
            <a id="next-lab" class="lab-nav-link" href="#" aria-label="Next lab">&raquo;</a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title"><a href="./docs.html">Back to Lab Index</a></h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Harden SSH configuration using precise <code>sed</code> substitutions against a test
                <code>sshd_config</code> file. You will disable root login, disable password
                authentication, and change the SSH port using CLI-only edits.
              </p>

              <!-- Video (kept on page; removed from left panel moving forward) -->
              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      src="https://www.youtube.com/embed/cUn2evRCIjo?si=jwYvqWmiVjAdYiie"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip"><span class="lab-chip-key">security</span></span>
                  <span class="lab-chip"><span class="lab-chip-key">services</span></span>
                  <span class="lab-chip"><span class="lab-chip-key">core</span></span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Scenario</h3>

                <p>
                  Your task is to harden SSH settings using the <code>sed</code> command. You have
                  a sample SSH daemon configuration at <code>/tmp/sshd_config</code>, and you must
                  apply three changes: set <code>PermitRootLogin</code> to <code>no</code>, set
                  <code>PasswordAuthentication</code> to <code>no</code>, and change the SSH
                  <code>Port</code> to <code>2222</code>.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    This lab reflects a standard production workflow: assess the current state,
                    apply targeted configuration changes, and verify the results. In a live
                    environment, you would also validate the syntax and restart <code>sshd</code>,
                    but the focus here is safe and controlled text manipulation.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Objective</h3>
                <ul>
                  <li>View an SSH daemon configuration file with <code>cat</code>.</li>
                  <li>Use anchored <code>sed</code> substitutions to change specific directives.</li>
                  <li>Confirm the resulting configuration values are correct.</li>
                </ul>
              </section>

              <!-- Concepts (no alt-background moving forward) -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Concepts</h3>
                <ul>
                  <li>
                    Treat configuration changes like change control: read current state, write a
                    minimal change, then re-check.
                  </li>
                  <li>
                    Anchoring with <code>^</code> reduces collateral edits by matching only directive
                    lines that start with the setting name.
                  </li>
                  <li>
                    SSH hardening is layered: authentication method, privileged access, and exposed
                    surface area (port) are adjusted together.
                  </li>
                  <li>
                    In-place edits are fast; verification is what makes them safe.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Walkthrough</h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>: View the current SSH daemon configuration.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-1">Copy</button>
                    </div>
                    <pre><code id="cmd-step-1">cat /tmp/sshd_config</code></pre>
                  </div>

                  <p>
                    Confirm the current directive values before modifying anything. This prevents
                    you from hardening the wrong file or guessing the current state.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-1"># SSH Daemon Configuration
PermitRootLogin yes
PasswordAuthentication yes
Port 22</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>: Disable root login by setting
                    <code>PermitRootLogin</code> to <code>no</code>.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-2">Copy</button>
                    </div>
                    <pre><code id="cmd-step-2">sed -i 's/^PermitRootLogin yes/PermitRootLogin no/' /tmp/sshd_config</code></pre>
                  </div>

                  <p>
                    The match is anchored with <code>^</code> so only the directive line starting with
                    <code>PermitRootLogin</code> is changed.
                  </p>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>: Disable password authentication by setting
                    <code>PasswordAuthentication</code> to <code>no</code>.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-3">Copy</button>
                    </div>
                    <pre><code id="cmd-step-3">sed -i 's/^PasswordAuthentication yes/PasswordAuthentication no/' /tmp/sshd_config</code></pre>
                  </div>

                  <p>
                    This performs a targeted substitution for the
                    <code>PasswordAuthentication</code> directive only.
                  </p>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>: Change the SSH port to <code>2222</code>.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button class="lab-copy-btn" type="button" data-copy="#cmd-step-4">Copy</button>
                    </div>
                    <pre><code id="cmd-step-4">sed -i 's/^Port 22/Port 2222/' /tmp/sshd_config</code></pre>
                  </div>

                  <p>
                    This updates the <code>Port</code> directive line from <code>22</code> to
                    <code>2222</code> without touching other lines.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code id="verify-step-4">PermitRootLogin no
PasswordAuthentication no
Port 2222</code></pre>
                  </div>
                </div>
              </section>

              <!-- Common breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Common breakpoints</h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">No change after running sed</div>
                  <p class="m-b-0">
                    The file may not match the expected values (for example, the directives are
                    commented out, already set to <code>no</code>, or use extra whitespace). Inspect
                    with <code>grep -nE '^(PermitRootLogin|PasswordAuthentication|Port)\\b' /tmp/sshd_config</code>
                    and adjust the match pattern.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Directive appears multiple times</div>
                  <p class="m-b-0">
                    In real <code>sshd_config</code> files, duplicates can exist, and the last match
                    usually wins. Your substitution might change only one line while another later
                    line overrides it. Use <code>grep -n</code> to find duplicates and resolve them.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Permission denied</div>
                  <p class="m-b-0">
                    If this were a real <code>/etc/ssh/sshd_config</code> edit, you would need
                    elevated privileges. Practice the same workflow with <code>sudo</code> when
                    appropriate.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Lockout risk in production</div>
                  <p class="m-b-0">
                    Disabling password auth and changing the port can lock you out if keys or
                    firewall rules are not in place. Always keep an active session open and validate
                    connectivity before you disconnect.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Cleanup checklist</h3>

                <p>
                  This lab modifies a temporary test file. Cleanup is resetting the file so you can
                  repeat the workflow.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Optional</span>
                    <button class="lab-copy-btn" type="button" data-copy="#cmd-cleanup">Copy</button>
                  </div>
                  <pre><code id="cmd-cleanup"># Reset /tmp/sshd_config back to the starting values for another repetition
sed -i 's/^PermitRootLogin no/PermitRootLogin yes/' /tmp/sshd_config
sed -i 's/^PasswordAuthentication no/PasswordAuthentication yes/' /tmp/sshd_config
sed -i 's/^Port 2222/Port 22/' /tmp/sshd_config

# Verify
cat /tmp/sshd_config</code></pre>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Success signal</div>
                  <p class="m-b-0">
                    You can make narrow, audit-friendly configuration changes using anchored matches,
                    then validate results immediately.
                  </p>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">Reference</h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>cat &lt;file&gt;</code>: Prints file contents to standard output.
                  </li>

                  <li>
                    <code>sed -i 's/pattern/replacement/' &lt;file&gt;</code>: Replaces the first match of
                    <code>pattern</code> on each line and writes changes back to the file.
                    <ul>
                      <li><code>-i</code>: Edit the file in place.</li>
                      <li><code>^</code>: Anchor the match to the start of the line.</li>
                      <li><code>s/old/new/</code>: Substitution operator.</li>
                    </ul>
                  </li>

                  <li><code>/tmp/sshd_config</code>: Temporary test configuration file used in this lab.</li>
                  <li><code>PermitRootLogin</code>: Controls whether the root user can log in over SSH.</li>
                  <li><code>PasswordAuthentication</code>: Controls whether SSH allows password-based logins.</li>
                  <li><code>Port</code>: Specifies the TCP port where <code>sshd</code> listens for incoming connections.</li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->

          <nav class="lab-pagination">
            <a id="prev-lab" class="lab-nav-link" href="#" aria-label="Previous lab">&uArr;</a>
          </nav>
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a href="https://github.com/vonds" target="_blank" rel="noopener">
                    Github
                  </a>
                </li>
                <li>
                  <a href="https://www.linkedin.com/in/vonds/" target="_blank" rel="noopener">
                    Linkedin
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy; <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById("year").textContent = new Date().getFullYear()
    </script>
  </body>
</html>
