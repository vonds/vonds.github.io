<!-- lab136.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 136</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="../assets/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Dosis"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a
                    href="https://github.com/vonds/exit_0"
                    target="_blank"
                    rel="noopener"
                  >
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener">
                    exit_0 Documentation
                  </a>
                </li>
                <li>
                  <a
                    href="https://github.com/vonds/sentinel"
                    target="_blank"
                    rel="noopener"
                  >
                    Sentinel
                  </a>
                </li>
              </ul>
            </li>

            <li>
              <a
                href="https://www.linkedin.com/in/vonds/"
                target="_blank"
                rel="noopener"
              >
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav
        class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top"
      >
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module" id="totop">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 136: Fix Missing Journal Logs and Restore Time Sync
          </h2>

          <nav class="lab-pagination">
            <a
              id="prev-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Previous lab"
            >
              &laquo;
            </a>
            <a
              id="next-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Next lab"
            >
              &raquo;
            </a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Investigate missing recent journal logs after an outage and
                restore log visibility for a service unit. Re-enable time
                synchronization using <code>chronyd</code> and prove the host is
                syncing again with <code>chronyc</code>.
              </p>

              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      src="https://www.youtube.com/embed/uu8PBNK8GWo?si=tIS-Qjv7qm_-8VIC"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip">
                    <span class="lab-chip-key">services</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">logging</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">time-sync</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">incident-response</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">core</span>
                  </span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Scenario
                </h3>

                <p>
                  This host is failing health checks after an outage. The app
                  team cannot find recent logs in the system journal, and TLS
                  checks fail because the system clock is drifting. Your job is
                  to restore journald visibility for the affected unit and
                  re-enable time synchronization.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    Health checks do not care why the outage happened. You need
                    logs for root cause work and accurate time for TLS,
                    authentication, and correlation across systems.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Objective
                </h3>

                <ul>
                  <li>
                    Confirm <code>systemd-journald</code> is running.
                  </li>
                  <li>
                    Inspect recent unit logs for <code>webapp.service</code>.
                  </li>
                  <li>Restart journald to restore logging flow.</li>
                  <li>Confirm logs from the current boot are present.</li>
                  <li>
                    Check time sync state and confirm NTP is not active.
                  </li>
                  <li>
                    Enable and start <code>chronyd</code> and turn NTP on.
                  </li>
                  <li>
                    Verify the host is syncing time using <code>chronyc</code>.
                  </li>
                </ul>
              </section>

              <!-- Concepts -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Concepts
                </h3>

                <ul>
                  <li>
                    “Missing logs” can be service state, journal state, scope
                    (wrong boot/unit), or disk pressure.
                  </li>
                  <li>
                    In incidents, scope to the current boot with
                    <code>journalctl -b</code> to avoid chasing old data.
                  </li>
                  <li>
                    Accurate time is a dependency for TLS, Kerberos, API
                    signatures, and cross-host correlation.
                  </li>
                  <li>
                    “Service is running” is not proof of sync; use
                    <code>chronyc tracking</code> for evidence.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Walkthrough
                </h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>
                    : Confirm journald is running.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-1"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-1">systemctl status systemd-journald --no-pager
# OR
sudo systemctl status systemd-journald --no-pager</code></pre>
                  </div>

                  <p>
                    Start with service health. If journald is down, you will not
                    get reliable unit logs.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>● systemd-journald.service - Journal Service
     Loaded: loaded (/usr/lib/systemd/system/systemd-journald.service; static)
     Active: active (running) since Thu 2026-01-15 11:03:12 UTC; 6min ago
   Main PID: 610 (systemd-journald)</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>
                    : Pull recent logs for the failing unit.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-2"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-2">journalctl -u webapp.service -n 20 --no-pager
# OR
sudo journalctl -u webapp.service -n 20 --no-pager</code></pre>
                  </div>

                  <p>
                    Unit-scoped logs keep output focused. If you see errors that
                    hint at disk pressure or journal write failures, treat that
                    as a strong lead.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Jan 15 11:06:41 host webapp[2142]: ERROR: failed to write to journal (No space left on device)
Jan 15 11:06:41 host webapp[2142]: WARN: continuing without structured logs</code></pre>
                  </div>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>
                    : Restart journald to restore logging.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-3"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-3">sudo systemctl restart systemd-journald
# OR
systemctl restart systemd-journald</code></pre>
                  </div>

                  <p>
                    A restart is a common first remediation when journaling is
                    wedged after an outage. Validate that logs are flowing again
                    next.
                  </p>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>
                    : Confirm logs exist for the current boot.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-4"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-4">journalctl -b -u webapp.service -n 10 --no-pager
# OR
sudo journalctl -b -u webapp.service -n 10 --no-pager</code></pre>
                  </div>

                  <p>
                    Scoping to the current boot (<code>-b</code>) proves you are
                    seeing live data, not old history.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Jan 15 11:09:02 host systemd[1]: Started webapp.service - Internal Web App.
Jan 15 11:09:02 host webapp[2310]: INFO: listening on 0.0.0.0:8080</code></pre>
                  </div>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>
                    : Check time synchronization state.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-5"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-5">timedatectl status
# OR
sudo timedatectl status</code></pre>
                  </div>

                  <p>
                    Confirm whether the system clock is synchronized and whether
                    an NTP service is active.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Local time: Thu 2026-01-15 11:09:10 UTC
Universal time: Thu 2026-01-15 11:09:10 UTC
RTC time: Thu 2026-01-15 10:37:51
Time zone: UTC (UTC, +0000)
System clock synchronized: no
NTP service: inactive</code></pre>
                  </div>
                </div>

                <!-- Step 6 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 6</strong>
                    : Enable time sync with <code>chronyd</code> and turn NTP on.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Commands</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-6"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-6">sudo systemctl enable --now chronyd
sudo timedatectl set-ntp true</code></pre>
                  </div>

                  <p>
                    Enable the chrony client and ensure NTP is turned on so the
                    host can converge with time sources.
                  </p>
                </div>

                <!-- Step 7 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 7</strong>
                    : Prove the system is syncing with <code>chrony</code>.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-136-7"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-136-7">chronyc tracking
# OR
sudo chronyc tracking</code></pre>
                  </div>

                  <p>
                    Look for a valid reference, a reasonable stratum, and a
                    normal leap status.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Reference ID    : 203.0.113.10 (ntp1.example.net)
Stratum         : 3
System time     : 0.000002341 seconds slow of NTP time
Last offset     : -0.000001102 seconds
Leap status     : Normal</code></pre>
                  </div>
                </div>
              </section>

              <!-- Breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Breakpoints
                </h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">No logs after restart</div>
                  <p class="m-b-0">
                    Confirm you are scoping correctly with <code>-b</code> and
                    <code>-u</code>. If the unit is not emitting logs, verify it
                    is actually starting and check
                    <code>systemctl status webapp.service</code>.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    Journal writes fail with disk pressure
                  </div>
                  <p class="m-b-0">
                    If you see “No space left on device”, journald can drop
                    messages even if the service is running. Confirm free space
                    on the filesystem that backs the journal and restore
                    headroom.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    Chrony is running but sync is not happening
                  </div>
                  <p class="m-b-0">
                    If <code>chronyc tracking</code> shows no reference or an
                    abnormal leap status, check network reachability to NTP
                    sources and confirm any egress firewall policy allows NTP.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Cleanup checklist
                </h3>

                <p>
                  If you need to disable NTP again for a controlled test, turn it
                  off and stop chrony.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button
                      class="lab-copy-btn"
                      type="button"
                      data-copy="#cmd-136-cleanup"
                    >
                      Copy
                    </button>
                  </div>
                  <pre><code id="cmd-136-cleanup">sudo timedatectl set-ntp false
sudo systemctl disable --now chronyd</code></pre>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Reference
                </h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>systemctl status &lt;unit&gt;</code>
                    : Check whether a unit is active and view recent status info.
                    <ul>
                      <li>
                        <code>--no-pager</code>
                        : Print output without paging.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>journalctl -u &lt;unit&gt;</code>
                    : View logs for a specific service unit.
                    <ul>
                      <li>
                        <code>-n &lt;N&gt;</code>
                        : Show the most recent N lines.
                      </li>
                      <li>
                        <code>--no-pager</code>
                        : Print output without paging.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>journalctl -b</code>
                    : Scope logs to a boot.
                    <ul>
                      <li>
                        <code>-b</code>
                        : Current boot (use <code>-b -1</code> for previous boot).
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>systemctl restart systemd-journald</code>
                    : Restart journald.
                  </li>

                  <li>
                    <code>timedatectl status</code>
                    : Show time, timezone, and synchronization state.
                  </li>

                  <li>
                    <code>systemctl enable --now chronyd</code>
                    : Enable chrony at boot and start it immediately.
                  </li>

                  <li>
                    <code>timedatectl set-ntp true|false</code>
                    : Enable or disable system time synchronization.
                  </li>

                  <li>
                    <code>chronyc tracking</code>
                    : Show chrony synchronization status and offset details.
                  </li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->

          <nav class="lab-pagination">
            <a class="lab-nav-link" href="#totop" aria-label="Back to top">
              &uArr;
            </a>
          </nav>
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a
                    href="https://github.com/vonds"
                    target="_blank"
                    rel="noopener"
                  >
                    Github
                  </a>
                </li>
                <li>
                  <a
                    href="https://www.linkedin.com/in/vonds/"
                    target="_blank"
                    rel="noopener"
                  >
                    Linkedin
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy; <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById("year").textContent = new Date().getFullYear()
    </script>
  </body>
</html>
