<!-- lab126.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 126</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="../assets/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Dosis"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a
                    href="https://github.com/vonds/exit_0"
                    target="_blank"
                    rel="noopener"
                  >
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank" rel="noopener"> exit_0 </a>
                </li>
              </ul>
            </li>

            <li>
              <a
                href="https://www.linkedin.com/in/vonds/"
                target="_blank"
                rel="noopener"
              >
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav
        class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top"
      >
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 126: Dynamic Linker &amp; Shared Library
          </h2>

          <nav class="lab-pagination">
            <a
              id="prev-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Previous lab"
            >
              &laquo;
            </a>
            <a
              id="next-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Next lab"
            >
              &raquo;
            </a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Inspect shared library dependencies with <code>ldd</code> and
                verify how the dynamic linker resolves libraries at runtime.
                Make <code>/opt/mylib</code> discoverable via
                <code>/etc/ld.so.conf.d</code> and <code>ldconfig</code>, then
                validate the cache and test a temporary override with
                <code>LD_LIBRARY_PATH</code>.
              </p>

              <!-- Video (kept on page; removed from left panel) -->
              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      src="https://www.youtube.com/embed/riJ_mKfIKR0?si=R5I0za6gk3SDpv6H"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip">
                    <span class="lab-chip-key">linker</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">libs</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">ldconfig</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">troubleshooting</span>
                  </span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Scenario
                </h3>

                <p>
                  A vendor shipped a binary that depends on a custom shared
                  library. The library was dropped under <code>/opt/mylib</code>
                  and the binary now fails to start because the dynamic linker
                  cannot find it. You need to prove what the binary needs, make
                  the new path discoverable, refresh the loader cache, and
                  validate resolution with a controlled, repeatable workflow.
                </p>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    Treat this as a dependency triage task. Confirm the missing
                    object, verify the search path and cache state, then apply a
                    minimal persistent fix via
                    <code>/etc/ld.so.conf.d</code>. Use
                    <code>LD_LIBRARY_PATH</code> only for testing or containment.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Objective
                </h3>
                <ul>
                  <li>
                    Inspect shared library dependencies for a known binary using
                    <code>ldd</code>.
                  </li>
                  <li>
                    Inspect the dynamic linker cache with
                    <code>ldconfig -p</code>.
                  </li>
                  <li>
                    Confirm how <code>/etc/ld.so.conf</code> includes snippet
                    files under <code>/etc/ld.so.conf.d</code>.
                  </li>
                  <li>
                    Add <code>/opt/mylib</code> to the loader search path using a
                    dedicated snippet file.
                  </li>
                  <li>
                    Rebuild the loader cache with <code>ldconfig</code> and
                    validate the new directory is scanned.
                  </li>
                  <li>
                    Use <code>LD_LIBRARY_PATH</code> as a temporary, per-shell
                    override.
                  </li>
                </ul>
              </section>

              <!-- Concepts (no alt-background moving forward) -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Concepts
                </h3>

                <ul>
                  <li>
                    ELF runtime linking: the dynamic loader resolves shared
                    libraries at process start.
                  </li>
                  <li>
                    Dependency inspection with <code>ldd</code> to surface
                    missing objects (<code>not found</code>).
                  </li>
                  <li>
                    Persistent linker configuration via
                    <code>/etc/ld.so.conf</code> and
                    <code>/etc/ld.so.conf.d/*.conf</code>.
                  </li>
                  <li>
                    Cache rebuild and visibility checks using
                    <code>ldconfig</code> and <code>ldconfig -p</code>.
                  </li>
                  <li>
                    Temporary search-path override with
                    <code>LD_LIBRARY_PATH</code> for scoped testing.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Walkthrough
                </h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>
                    : Inspect shared library dependencies for a known binary.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-1"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-1">ldd /bin/ls</code></pre>
                  </div>

                  <p>
                    This prints loader resolution results: which libraries are
                    required and what paths they map to. When a dependency
                    cannot be resolved, you will typically see
                    <code>not found</code>.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code># Example pattern:
# libselinux.so.1 => /lib64/libselinux.so.1 (0x00007f...)
# libdoesnotexist.so => not found</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>
                    : Inspect the dynamic linker cache.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-2"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-2">ldconfig -p | head</code></pre>
                  </div>

                  <p>
                    <code>ldconfig -p</code>
                    prints what is currently known in
                    <code>ld.so.cache</code>. If a library directory is not
                    configured, its objects will not appear here.
                  </p>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>
                    : Confirm how <code>ld.so.conf</code> is wired.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-3"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-3">grep -E '^[^#]' /etc/ld.so.conf</code></pre>
                  </div>

                  <p>
                    Most systems include drop-in snippet files via
                    <code>/etc/ld.so.conf.d/*.conf</code>. That is the preferred
                    place to add custom library paths without editing the
                    top-level file directly.
                  </p>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>
                    : List existing snippet files.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-4"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-4">ls -1 /etc/ld.so.conf.d</code></pre>
                  </div>

                  <p>
                    These files define additional search directories. Keep your
                    change isolated in a single, clearly named snippet so it is
                    easy to audit and roll back.
                  </p>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>
                    : Add <code>/opt/mylib</code> via a new snippet file.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-5"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-5">echo /opt/mylib | sudo tee /etc/ld.so.conf.d/mylib.conf</code></pre>
                  </div>

                  <div class="lab-callout">
                    <div class="lab-callout-label">Expectation</div>
                    <p class="m-b-0">
                      This only writes configuration. The loader cache will not
                      change until you run <code>ldconfig</code>.
                    </p>
                  </div>
                </div>

                <!-- Step 6 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 6</strong>
                    : Rebuild the dynamic linker cache.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-6"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-6">sudo ldconfig</code></pre>
                  </div>

                  <p>
                    <code>ldconfig</code>
                    scans configured directories and rebuilds
                    <code>ld.so.cache</code>. This is the step that makes the
                    new directory effective system-wide.
                  </p>
                </div>

                <!-- Step 7 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 7</strong>
                    : Prove <code>ldconfig</code> scanned the new directory.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-7"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-7">sudo ldconfig -v 2>/dev/null | grep -m1 /opt/mylib</code></pre>
                  </div>

                  <p>
                    This is a quick sanity check. If the directory does not
                    appear, the snippet was not read or the file contents are
                    invalid.
                  </p>
                </div>

                <!-- Step 8 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 8</strong>
                    : Use <code>LD_LIBRARY_PATH</code> as a temporary override.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-8"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-8">export LD_LIBRARY_PATH=/opt/mylib:$LD_LIBRARY_PATH</code></pre>
                  </div>

                  <p>
                    This prepends <code>/opt/mylib</code> for processes launched
                    from the current shell. It does not modify system
                    configuration and will not persist across sessions.
                  </p>

                  <div class="lab-callout">
                    <div class="lab-callout-label">Operational note</div>
                    <p class="m-b-0">
                      Services started by systemd will not inherit this unless
                      explicitly configured in the unit or environment file. Use
                      this for validation, not as a long-term deployment
                      strategy.
                    </p>
                  </div>
                </div>
              </section>

              <!-- Common breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Common breakpoints
                </h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">ldd shows “not found”</div>
                  <p class="m-b-0">
                    The library is missing, the path is not configured, or the
                    SONAME does not match what the binary requests. Confirm the
                    library exists under <code>/opt/mylib</code>, then rebuild
                    the cache with <code>ldconfig</code>.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    Snippet exists but ldconfig does not scan it
                  </div>
                  <p class="m-b-0">
                    The snippet must contain a valid directory path on its own
                    line. Also confirm <code>/etc/ld.so.conf</code> includes
                    <code>/etc/ld.so.conf.d/*.conf</code>.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    LD_LIBRARY_PATH works in a shell but not for a service
                  </div>
                  <p class="m-b-0">
                    That is expected. It only affects the current shell’s
                    process tree. If a service needs it for testing, define the
                    environment in the systemd unit or an environment file.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    Global search path change has unintended impact
                  </div>
                  <p class="m-b-0">
                    Adding directories changes how multiple binaries resolve
                    libraries. Keep paths narrow, prefer dedicated directories,
                    and revalidate the target binary with <code>ldd</code> after
                    changes.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Cleanup checklist
                </h3>

                <p>
                  If you created a snippet under <code>/etc/ld.so.conf.d</code>,
                  remove it and rebuild the cache to revert the system-wide
                  search path.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button
                      class="lab-copy-btn"
                      type="button"
                      data-copy="#cmd-cleanup"
                    >
                      Copy
                    </button>
                  </div>
                  <pre><code id="cmd-cleanup">sudo rm -f /etc/ld.so.conf.d/mylib.conf
sudo ldconfig
ldconfig -p | grep -m1 /opt/mylib || true</code></pre>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Success signal</div>
                  <p class="m-b-0">
                    <code>ldconfig -v</code>
                    no longer lists <code>/opt/mylib</code>, and the cache output
                    does not surface libraries from that directory.
                  </p>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Reference
                </h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>ldd &lt;binary&gt;</code>
                    : Shows runtime shared library dependencies for an ELF
                    binary.
                  </li>

                  <li>
                    <code>ldconfig -p</code>
                    : Displays the current dynamic linker cache contents.
                  </li>

                  <li>
                    <code>grep -E '^[^#]' /etc/ld.so.conf</code>
                    : Displays active (non-comment) loader configuration lines.
                  </li>

                  <li>
                    <code>ls -1 /etc/ld.so.conf.d</code>
                    : Lists drop-in snippet files used by the loader
                    configuration.
                    <ul>
                      <li>
                        <code>/etc/ld.so.conf.d/*.conf</code>
                        : Directory of snippet files that add search paths.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>echo &lt;dir&gt; | sudo tee /etc/ld.so.conf.d/&lt;name&gt;.conf</code>
                    : Writes a new search path snippet for the dynamic linker.
                    <ul>
                      <li>
                        <code>tee</code>
                        : Writes to a root-owned file while still accepting
                        stdin from a pipeline.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>ldconfig</code>
                    : Rebuilds the dynamic linker cache based on configured
                    directories.
                  </li>

                  <li>
                    <code>ldconfig -v</code>
                    : Shows verbose scan output (useful for proving a directory
                    is read).
                    <ul>
                      <li>
                        <code>-v</code>
                        : Enables verbose scanning output.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>LD_LIBRARY_PATH=&lt;dir&gt;:&lt;existing&gt;</code>
                    : Temporarily prepends directories to the library search path
                    for a process tree.
                  </li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a
                    href="https://github.com/vonds"
                    target="_blank"
                    rel="noopener"
                    >Github</a
                  >
                </li>
                <li>
                  <a
                    href="https://www.linkedin.com/in/vonds/"
                    target="_blank"
                    rel="noopener"
                    >Linkedin</a
                  >
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy; <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.css"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear()
    </script>
  </body>
</html>
