<!-- lab150.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="exit_0 Documentation" />
    <meta name="name" content="Vonds" />

    <title>Vonds | Lab 150</title>

    <!-- Favicons -->
    <link rel="shortcut icon" href="../assets/images/favicon.png" />
    <link rel="apple-touch-icon" href="../assets/images/apple-touch-icon.png" />
    <link
      rel="apple-touch-icon"
      sizes="72x72"
      href="../assets/images/apple-touch-icon-72x72.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="114x114"
      href="../assets/images/apple-touch-icon-114x114.png"
    />

    <!-- Site styles (your existing) -->
    <link href="../assets/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
    <link href="../assets/css/font-awesome.min.css" rel="stylesheet" />
    <link href="../assets/css/linea-icons.css" rel="stylesheet" />
    <link href="../assets/css/ionicons.min.css" rel="stylesheet" />
    <link href="../assets/css/simpletextrotator.css" rel="stylesheet" />
    <link href="../assets/css/magnific-popup.css" rel="stylesheet" />
    <link href="../assets/css/owl.carousel.css" rel="stylesheet" />
    <link href="../assets/css/superslides.css" rel="stylesheet" />
    <link href="../assets/css/vertical.css" rel="stylesheet" />
    <link href="../assets/css/animate.css" rel="stylesheet" />
    <link href="../assets/css/style.css" rel="stylesheet" />
    <link href="../assets/css/docs.css" rel="stylesheet" />

    <!-- Lab page styles -->
    <link href="../assets/css/lab.css" rel="stylesheet" />

    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Dosis"
      rel="stylesheet"
    />
  </head>

  <body>
    <!-- PRELOADER -->
    <div class="page-loader">
      <div class="loader">Loading...</div>
    </div>

    <!-- OVERLAY MENU -->
    <div id="overlay-menu" class="overlay-menu">
      <a href="#" id="overlay-menu-hide" class="navigation-hide">
        <i class="ion-close-round"></i>
      </a>

      <div class="overlay-menu-inner">
        <nav class="overlay-menu-nav">
          <ul id="nav">
            <li><a href="../index.html">Home</a></li>

            <li class="slidedown">
              <a href="#">Portfolio</a>
              <ul>
                <li>
                  <a href="https://github.com/vonds/exit_0" target="_blank">
                    exit_0
                  </a>
                </li>
                <li>
                  <a href="https://github.com/vonds/sentinel" target="_blank">
                    Sentinel
                  </a>
                </li>
                <li>
                  <a href="docs.html" target="_blank">exit_0 Documentation</a>
                </li>
              </ul>
            </li>

            <li>
              <a
                href="https://www.linkedin.com/in/vonds/"
                target="_blank"
                rel="noopener"
              >
                LinkedIn
              </a>
            </li>
            <li>
              <a href="https://github.com/vonds" target="_blank" rel="noopener">
                Github
              </a>
            </li>
            <li>
              <a href="mailto:vonds13@gmail.com?subject=Hello Vonds">Contact</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="overlay-navigation-footer">
        <div class="container">
          <div class="row">
            <div class="col-sm-12 text-center">
              <p class="copyright font-alt m-b-0">
                VONDS &copy;
                <script>
                  document.write(new Date().getFullYear())
                </script>
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- WRAPPER -->
    <div class="wrapper">
      <!-- NAVIGATION -->
      <nav
        class="navbar navbar-custom navbar-transparent navbar-light navbar-fixed-top"
      >
        <div class="container">
          <div class="navbar-header">
            <a class="navbar-brand" href="../index.html">
              <img src="../assets/images/logo-dark.png" width="95" alt="" />
            </a>
          </div>

          <ul id="icons-navbar" class="nav navbar-nav navbar-right">
            <li>
              <a href="#" id="toggle-menu" class="show-overlay" title="Menu">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
            </li>
          </ul>
        </div>
      </nav>

      <!-- DOCS PAGE -->
      <section class="module">
        <div class="container">
          <h2 class="font-alt module-title m-t-60">
            Lab 150: RHCSA useradd — Defaults + Realistic Provisioning Workflow
          </h2>

          <nav class="lab-pagination">
            <a
              id="prev-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Previous lab"
            >
              &laquo;
            </a>
            <a
              id="next-lab"
              class="lab-nav-link"
              href="#"
              aria-label="Next lab"
            >
              &raquo;
            </a>
          </nav>

          <div class="row">
            <!-- LEFT SIDEBAR -->
            <div class="col-sm-4 col-md-3 lab-sidebar">
              <div class="docs-sidebar">
                <div class="docs-widget">
                  <h5 class="widget-title">
                    <a href="./docs.html">Back to Lab Index</a>
                  </h5>
                  <ul class="docs-nav">
                    <li><a href="#scenario">Scenario</a></li>
                    <li><a href="#objective">Objective</a></li>
                    <li><a href="#concepts">Concepts</a></li>
                    <li><a href="#walkthrough">Walkthrough</a></li>
                    <li><a href="#breakpoints">Breakpoints</a></li>
                    <li><a href="#cleanup">Cleanup</a></li>
                    <li><a href="#reference">Reference</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <!-- MAIN CONTENT -->
            <div class="col-sm-8 col-md-9 lab-doc">
              <p class="m-b-20 lab-summary">
                Confirm system-wide useradd defaults, ensure prerequisite groups
                exist, provision a contractor account in a single ticket-style
                command, then verify identity, NSS records, and expiration
                settings using getent, id, and chage. Finish with clean lab
                hygiene by removing the user and home directory.
              </p>

              <!-- Video (kept on page; removed from left panel) -->
              <section class="lab-section" id="video" aria-label="Lab video">
                <div class="lab-video">
                  <div class="lab-video-embed text-center">
                    <iframe
                      src="https://www.youtube.com/embed/uJk54bhaadA?si=seGSukCoMFN7ohRo"
                      title="YouTube video player"
                      frameborder="0"
                      allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                      referrerpolicy="strict-origin-when-cross-origin"
                      allowfullscreen
                    ></iframe>
                  </div>
                </div>
              </section>

              <!-- Scenario -->
              <section class="lab-section" id="scenario">
                <div class="lab-chips" aria-label="Tags">
                  <span class="lab-chip">
                    <span class="lab-chip-key">users</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">security</span>
                  </span>
                  <span class="lab-chip">
                    <span class="lab-chip-key">core</span>
                  </span>
                </div>

                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Scenario
                </h3>

                <p>
                  Ticket INC-150: Onboard a contractor account
                  <strong>satoshi</strong>
                  for a short change window. Requirements:
                </p>

                <ul>
                  <li>UID 1055, home /home/satoshi, shell /bin/bash</li>
                  <li>Primary group developers, supplementary groups wheel,docker</li>
                  <li>Comment: Satoshi Nakamoto</li>
                  <li>Account expires 2025-12-31</li>
                  <li>Inactive lockout: 30 days after password expiry (policy setting)</li>
                </ul>

                <div class="lab-callout">
                  <div class="lab-callout-label">Operator context</div>
                  <p class="m-b-0">
                    Confirm defaults first, create the account once with the full
                    spec, verify like a real admin, then clean up the lab host.
                  </p>
                </div>
              </section>

              <!-- Objective -->
              <section class="lab-section alt-background" id="objective">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Objective
                </h3>
                <ul>
                  <li>Inspect system-wide useradd defaults.</li>
                  <li>Ensure required groups exist: developers, wheel, docker.</li>
                  <li>Create satoshi in one useradd command meeting all requirements.</li>
                  <li>Verify NSS passwd record with getent.</li>
                  <li>Verify primary and supplementary groups with id.</li>
                  <li>Validate account expiry and aging fields with chage.</li>
                  <li>Remove the user and home directory after verification.</li>
                </ul>
              </section>

              <!-- Concepts (no alt-background moving forward) -->
              <section class="lab-section" id="concepts">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Concepts
                </h3>
                <ul>
                  <li>
                    Inspecting defaults with
                    <code>useradd -D</code>
                    before provisioning.
                  </li>
                  <li>
                    Prerequisite group creation using
                    <code>groupadd -f</code>
                    to keep runs idempotent.
                  </li>
                  <li>
                    Ticket-style account creation in a single
                    <code>useradd</code>
                    command using UID, primary group, supplementary groups,
                    comment, shell, home, expiry, and inactive settings.
                  </li>
                  <li>
                    NSS verification:
                    <code>getent passwd</code>
                    provides the authoritative user record view for the system.
                  </li>
                  <li>
                    Identity verification:
                    <code>id</code>
                    proves group membership by name (GIDs can vary).
                  </li>
                  <li>
                    Expiration and aging review:
                    <code>chage -l</code>
                    reports account expiry, password ageing fields, and derived dates.
                  </li>
                </ul>
              </section>

              <!-- Walkthrough -->
              <section class="lab-section alt-background" id="walkthrough">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Walkthrough
                </h3>

                <!-- Step 1 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 1</strong>
                    : Show system-wide default settings for useradd.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-1"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-1">useradd -D</code></pre>
                  </div>

                  <p>
                    Defaults matter because they silently apply to new accounts.
                    This is where you confirm baseline HOME, SHELL, SKEL, and
                    global INACTIVE/EXPIRE defaults before you override anything
                    per-ticket.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes</code></pre>
                  </div>
                </div>

                <!-- Step 2 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 2</strong>
                    : Ensure required groups exist.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-2"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-2">sudo groupadd -f developers && sudo groupadd -f docker && sudo groupadd -f wheel</code></pre>
                  </div>

                  <p>
                    Using
                    <code>-f</code>
                    makes the command safe to rerun. If the group already
                    exists, groupadd exits successfully and the workflow stays
                    predictable.
                  </p>
                </div>

                <!-- Step 3 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 3</strong>
                    : Create satoshi in one useradd command.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-3"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-3">sudo useradd -m -u 1055 -g developers -G wheel,docker -c 'Satoshi Nakamoto' -s /bin/bash -d /home/satoshi -e 2025-12-31 -f 30 satoshi</code></pre>
                  </div>

                  <p>
                    This is the ticket-style “do it once” provisioning command.
                    It creates the home directory, pins the UID, sets primary
                    and supplementary groups, writes the gecos comment, sets
                    shell and home, enforces an account expiration date, and
                    sets the inactivity lockout window.
                  </p>
                </div>

                <!-- Step 4 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 4</strong>
                    : Verify the passwd database entry via NSS.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-4"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-4">getent passwd satoshi</code></pre>
                  </div>

                  <p>
                    <code>getent</code>
                    confirms the system’s authoritative user record view,
                    including UID, primary GID, home directory, and login shell.
                    GID numbers vary across systems, so focus on the group name
                    mapping.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>satoshi:x:1055:1001:Satoshi Nakamoto:/home/satoshi:/bin/bash
(GID number may vary; primary group must be developers)</code></pre>
                  </div>
                </div>

                <!-- Step 5 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 5</strong>
                    : Verify group memberships.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-5"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-5">id satoshi</code></pre>
                  </div>

                  <p>
                    <code>id</code>
                    is the practical verification for access and privilege. The
                    ticket requirement is group names: developers as the primary
                    group, and wheel and docker as supplementary groups.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>uid=1055(satoshi) gid=1001(developers) groups=1001(developers),10(wheel),993(docker)
(group IDs may vary; group NAMES must include developers, wheel, docker)</code></pre>
                  </div>
                </div>

                <!-- Step 6 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 6</strong>
                    : Verify account expiration and aging fields using chage.
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-6"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-6">sudo chage -l satoshi</code></pre>
                  </div>

                  <p>
                    <code>chage -l</code>
                    confirms the account expiration date and displays password
                    aging fields. Note that password expiry fields can show
                    “never” on new accounts until a password policy is applied
                    and a password is set.
                  </p>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <pre><code>Last password change                                    : Feb 01, 2026
Password expires                                        : never
Password inactive                                       : never
Account expires                                         : Dec 31, 2025
Minimum number of days between password change          : 0
Maximum number of days between password change          : 99999
Number of days of warning before password expires       : 7</code></pre>
                  </div>
                </div>

                <!-- Step 7 -->
                <div class="lab-step">
                  <div class="lab-step-title">
                    <strong class="font-alt">Step 7</strong>
                    : Cleanup after verification (remove user and home directory).
                  </div>

                  <div class="lab-codeblock m-b-40 m-t-40">
                    <div class="lab-codeblock-header">
                      <span>Command</span>
                      <button
                        class="lab-copy-btn"
                        type="button"
                        data-copy="#cmd-step-7"
                      >
                        Copy
                      </button>
                    </div>
                    <pre><code id="cmd-step-7">sudo userdel -r satoshi</code></pre>
                  </div>

                  <p>
                    Removing the user and home directory keeps the lab host
                    clean and repeatable. In a real environment, cleanup would
                    also include access revocation and audit trail updates.
                  </p>
                </div>
              </section>

              <!-- Common breakpoints -->
              <section class="lab-section" id="breakpoints">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Common breakpoints
                </h3>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    useradd fails: “UID 1055 is not unique”
                  </div>
                  <p class="m-b-0">
                    The ticket UID collides with an existing account. Verify the
                    current UID allocation and either pick a new UID per policy
                    or deconflict with the requester.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    Primary group developers does not exist
                  </div>
                  <p class="m-b-0">
                    Create prerequisite groups first. If the group is managed by
                    directory services, ensure NSS is configured correctly and
                    the group is resolvable via
                    <code>getent group developers</code>
                    .
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    Supplementary groups are missing in id output
                  </div>
                  <p class="m-b-0">
                    Ensure you used
                    <code>-G wheel,docker</code>
                    and verify group names match exactly. If you are modifying an
                    existing user, use
                    <code>usermod -aG</code>
                    to avoid overwriting groups.
                  </p>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">
                    chage does not show expected behavior for inactive lockout
                  </div>
                  <p class="m-b-0">
                    The inactive window applies after password expiry. If the
                    password is set to never expire, inactive will also be
                    irrelevant. Confirm password policy and expiration settings
                    if you need to test inactive lockouts realistically.
                  </p>
                </div>
              </section>

              <!-- Cleanup -->
              <section class="lab-section alt-background" id="cleanup">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Cleanup checklist
                </h3>

                <p>
                  This lab is complete after verification and user removal. If
                  you are repeating runs, confirm the user no longer exists and
                  the home directory is gone.
                </p>

                <div class="lab-codeblock m-b-40 m-t-40">
                  <div class="lab-codeblock-header">
                    <span>Commands</span>
                    <button
                      class="lab-copy-btn"
                      type="button"
                      data-copy="#cmd-cleanup"
                    >
                      Copy
                    </button>
                  </div>
                  <pre><code id="cmd-cleanup">getent passwd satoshi
ls -ld /home/satoshi</code></pre>
                </div>

                <div class="lab-callout">
                  <div class="lab-callout-label">Success signal</div>
                  <p class="m-b-0">
                    <code>getent passwd satoshi</code>
                    returns no output and
                    <code>/home/satoshi</code>
                    does not exist.
                  </p>
                </div>
              </section>

              <!-- Reference -->
              <section class="lab-section" id="reference">
                <h3 class="font-alt lab-section-title m-b-40 m-t-40">
                  Reference
                </h3>

                <ul class="lab-reference-list">
                  <li>
                    <code>useradd -D</code>
                    : Displays system-wide defaults for new accounts.
                    <ul>
                      <li>
                        <code>-D</code>
                        : Show or set default values.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>groupadd -f &lt;group&gt;</code>
                    : Creates a group if it does not exist.
                    <ul>
                      <li>
                        <code>-f</code>
                        : Exit successfully if the group already exists.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>useradd -m -u &lt;uid&gt; -g &lt;group&gt; -G &lt;g1,g2&gt; -c '&lt;comment&gt;' -s &lt;shell&gt; -d &lt;home&gt; -e &lt;YYYY-MM-DD&gt; -f &lt;days&gt; &lt;user&gt;</code>
                    : Creates a user with explicit ticket requirements.
                    <ul>
                      <li>
                        <code>-m</code>
                        : Create the user’s home directory.
                      </li>
                      <li>
                        <code>-u</code>
                        : Set numeric UID.
                      </li>
                      <li>
                        <code>-g</code>
                        : Set primary group.
                      </li>
                      <li>
                        <code>-G</code>
                        : Set supplementary groups (comma-separated).
                      </li>
                      <li>
                        <code>-c</code>
                        : Set account comment (GECOS).
                      </li>
                      <li>
                        <code>-s</code>
                        : Set login shell.
                      </li>
                      <li>
                        <code>-d</code>
                        : Set home directory path.
                      </li>
                      <li>
                        <code>-e</code>
                        : Set account expiration date.
                      </li>
                      <li>
                        <code>-f</code>
                        : Set inactive days after password expiry.
                      </li>
                    </ul>
                  </li>

                  <li>
                    <code>getent passwd &lt;user&gt;</code>
                    : Shows the NSS passwd entry for a user.
                  </li>

                  <li>
                    <code>id &lt;user&gt;</code>
                    : Displays UID, primary group, and supplementary groups.
                  </li>

                  <li>
                    <code>chage -l &lt;user&gt;</code>
                    : Shows password aging and account expiration details.
                  </li>

                  <li>
                    <code>userdel -r &lt;user&gt;</code>
                    : Removes the user and their home directory.
                    <ul>
                      <li>
                        <code>-r</code>
                        : Remove home directory and mail spool.
                      </li>
                    </ul>
                  </li>
                </ul>
              </section>
            </div>
            <!-- /main -->
          </div>
          <!-- /row -->
        </div>
        <!-- /container -->
      </section>

      <!-- FOOTER -->
      <footer class="module bg-light">
        <div class="container">
          <div class="row">
            <div class="col-sm-12">
              <ul class="social-text-links font-alt text-center m-b-20">
                <li>
                  <a
                    href="https://github.com/vonds"
                    target="_blank"
                    rel="noopener"
                  >
                    Github
                  </a>
                </li>
                <li>
                  <a
                    href="https://www.linkedin.com/in/vonds/"
                    target="_blank"
                    rel="noopener"
                  >
                    Linkedin
                  </a>
                </li>
              </ul>
            </div>
          </div>

          <div class="row">
            <div class="col-sm-12">
              <p class="copyright text-center m-b-0">
                VONDS &copy;
                <span id="year"></span>
              </p>

              <div class="scroll-up">
                <a href="#totop"><i class="fa fa-angle-double-up"></i></a>
              </div>
            </div>
          </div>
        </div>
      </footer>
    </div>

    <!-- Javascript files (your existing) -->
    <script src="../assets/js/jquery-2.2.4.min.js"></script>
    <script src="../assets/bootstrap/js/bootstrap.min.css"></script>
    <script src="../assets/js/jquery.superslides.min.js"></script>
    <script src="../assets/js/jquery.mb.YTPlayer.min.js"></script>
    <script src="../assets/js/jquery.magnific-popup.min.js"></script>
    <script src="../assets/js/owl.carousel.min.js"></script>
    <script src="../assets/js/jquery.simple-text-rotator.min.js"></script>
    <script src="../assets/js/imagesloaded.pkgd.js"></script>
    <script src="../assets/js/isotope.pkgd.min.js"></script>
    <script src="../assets/js/packery-mode.pkgd.min.js"></script>
    <script src="../assets/js/appear.js"></script>
    <script src="../assets/js/jquery.easing.1.3.js"></script>
    <script src="../assets/js/wow.min.js"></script>
    <script src="../assets/js/jqBootstrapValidation.js"></script>
    <script src="../assets/js/jquery.fitvids.js"></script>
    <script src="../assets/js/jquery.parallax-1.1.3.js"></script>
    <script src="../assets/js/smoothscroll.js"></script>
    <script src="../assets/js/custom.js"></script>

    <!-- Lab page JS (new) -->
    <script src="../assets/js/lab.js"></script>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear()
    </script>
  </body>
</html>
